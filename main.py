import os
from telegram import Update, ReplyKeyboardMarkup
from telegram.ext import (
    ApplicationBuilder,
    CommandHandler,
    MessageHandler,
    ContextTypes,
    filters,
)

TOKEN = os.getenv("BOT_TOKEN")

# --- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é ---
MAIN_MENU = ReplyKeyboardMarkup(
    [
        ["üìâ –ü–æ—á–µ–º—É –Ω–µ—Ç –ø—Ä–æ–¥–∞–∂", "üõç –£–ª—É—á—à–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É"],
        ["üìä –ê–Ω–∞–ª–∏–∑ –Ω–∏—à–∏", "üí∞ –†–∞—Å—á—ë—Ç –ø—Ä–∏–±—ã–ª–∏"],
        ["üí° –ò–¥–µ–∏ —Ç–æ–≤–∞—Ä–æ–≤"],
        ["‚ùì –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç", "üíº –¢–∞—Ä–∏—Ñ—ã"],
    ],
    resize_keyboard=True
)

# --- /start ---
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text(
        "üöÄ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ MarketBot!\n\n"
        "–Ø –ø–æ–º–æ–≥–∞—é –ø—Ä–æ–¥–∞–≤—Ü–∞–º –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–æ–≤\n"
        "–Ω–∞—Ö–æ–¥–∏—Ç—å —Å–ª–∞–±—ã–µ –º–µ—Å—Ç–∞ –∏ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –ø—Ä–∏–±—ã–ª—å.",
        reply_markup=MAIN_MENU
    )

# --- –û—Ç–≤–µ—Ç—ã –Ω–∞ –∫–Ω–æ–ø–∫–∏ ---
async def menu_handler(update: Update, context: ContextTypes.DEFAULT_TYPE):
    text = update.message.text

    responses = {
        "üìâ –ü–æ—á–µ–º—É –Ω–µ—Ç –ø—Ä–æ–¥–∞–∂": "–Ø –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É—é —Ç–≤–æ—é –∫–∞—Ä—Ç–æ—á–∫—É –∏ –ø–æ–∫–∞–∂—É, —á—Ç–æ –º–µ—à–∞–µ—Ç –ø—Ä–æ–¥–∞–∂–∞–º.",
        "üõç –£–ª—É—á—à–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É": "–ü–µ—Ä–µ–ø–∏—à—É –∑–∞–≥–æ–ª–æ–≤–æ–∫, –æ–ø–∏—Å–∞–Ω–∏–µ –∏ SEO –ø–æ–¥ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞.",
        "üìä –ê–Ω–∞–ª–∏–∑ –Ω–∏—à–∏": "–ü—Ä–æ–≤–µ—Ä—é —Å–ø—Ä–æ—Å, –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—é –∏ —Ä–∏—Å–∫–∏ –Ω–∏—à–∏.",
        "üí∞ –†–∞—Å—á—ë—Ç –ø—Ä–∏–±—ã–ª–∏": "–ü–æ—Å—á–∏—Ç–∞—é —Ä–µ–∞–ª—å–Ω—É—é –ø—Ä–∏–±—ã–ª—å —Å —É—á—ë—Ç–æ–º –∫–æ–º–∏—Å—Å–∏–π –∏ –ª–æ–≥–∏—Å—Ç–∏–∫–∏.",
        "üí° –ò–¥–µ–∏ —Ç–æ–≤–∞—Ä–æ–≤": "–ü–æ–¥–±–µ—Ä—É –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –ø–æ–¥ —Ç–≤–æ–π –±—é–¥–∂–µ—Ç.",
        "‚ùì –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç": "–¢—ã –≤—ã–±–∏—Ä–∞–µ—à—å —Ñ—É–Ω–∫—Ü–∏—é ‚Äî —è –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é –∏ –¥–∞—é —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.",
        "üíº –¢–∞—Ä–∏—Ñ—ã": "–°–∫–æ—Ä–æ –∑–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è —Ç–∞—Ä–∏—Ñ—ã –∏ –ø–æ–¥–ø–∏—Å–∫–∞."
    }

    reply = responses.get(text, "–í—ã–±–µ—Ä–∏ –ø—É–Ω–∫—Ç –∏–∑ –º–µ–Ω—é üëá")
    await update.message.reply_text(reply)

# --- –ó–∞–ø—É—Å–∫ ---
def main():
    app = ApplicationBuilder().token(TOKEN).build()
    app.add_handler(CommandHandler("start", start))
    app.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, menu_handler))
    app.run_polling()

if __name__ == "__main__":
    main()
